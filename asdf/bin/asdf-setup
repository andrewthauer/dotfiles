#!/usr/bin/env zsh
#
# Setup asdf version manager
#

# Install asdf (if required)
if [[ ! -d "${HOME}/.asdf" ]]; then
  ASDF_VERSION=v0.4.3
  echo "Installing asdf -- ${ASDF_VERISON}"
  git clone https://github.com/asdf-vm/asdf.git ~/.asdf --branch ${ASDF_VERSION}
  echo "\nReloading shell ..."
  source ~/.zshrc
fi

# Update asdf
echo "\nUpdating asdf ..."
asdf update

# Add plugins
echo "\nAdding asdf plugins ..."
asdf plugin-add elm
asdf plugin-add nodejs
asdf plugin-add python
asdf plugin-add ruby

# Import the Node.js release team's OpenPGP keys to main keyring:
# echo "\nImporting Node.js OpenPGP keys ..."
# bash ~/.asdf/plugins/nodejs/bin/import-release-team-keyring

# Get current versions
echo "\nFetching latest versions ..."
source "${0:h}/asdf-versions"

#
# Install versions
#

echo "\nInstalling lastest versions ..."

# elm
asdf install elm ${ELM_VERSION}
asdf global elm ${ELM_VERSION}

# nodejs
asdf install nodejs ${NODE_LTS_VERSION}
asdf global nodejs ${NODE_LTS_VERSION}

# python
asdf install python ${PYTHON_VERSION}
asdf install python ${PYTHON2_VERSION}
asdf global python ${PYTHON_VERSION}

# ruby
asdf install ruby ${RUBY_VERSION}
asdf global ruby ${RUBY_VERSION}
