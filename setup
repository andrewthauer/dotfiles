#!/bin/zsh

# Create symlink to this directory
DOTFILES="$(cd "$(dirname "${BASH_SOURCE[0]}")" && pwd)"
if [[ ! -d "$DOTFILES" ]] && [[ ! -L "$DOTFILES" ]]; then
  ln -s $DOTFILES "$HOME/.dotfiles"
fi

# Export dot files dir
export DOTFILES="$HOME/.dotfiles"

# Initialize
[[ -s "$DOTFILES/init.zsh" ]] && source "$DOTFILES/init.zsh"

# Symlink directories
echo "\n=== Symlinking files & directories ===\n"
dotfiles_symlink_dir "./bash"
dotfiles_symlink_dir "./editorconfig"
dotfiles_symlink_dir "./git"
dotfiles_symlink_dir "./secrets"
dotfiles_symlink_dir "./slate"
dotfiles_symlink_dir "./vim"
dotfiles_symlink_dir "./zsh"

# Update zgen
echo "\n=== Updating zgen ===\n"
dotfiles_require 'zgen'
git submodule update --init --recursive
zgen update && src

# Reload zsh
echo "\nRestart your shell ...\n"
