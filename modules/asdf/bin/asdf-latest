#!/usr/bin/env bash
#
# description:
#   Get the latest tool version from asdf
#
# usage:
#   asdf-latest [plugin] [filter]
#
# examples:
#   asdf-latest nodejs
#   asdf-latest nodejs 8
#

plugin=$1
filter=$2
version=
number_regex='^[0-9]+([.][0-9]+)?$'

if [[ -z "${filter}" ]]; then
  version="$(asdf list-all $plugin | grep -v "[a-zA-Z]" | tail -n 1)"
elif ! [[ ${filter} =~ $number_regex ]]; then
  version="$(asdf list-all $plugin | grep "^$filter" | tail -n 1)"
else
  version="$(asdf list-all $plugin | grep "^$filter" | grep -v "[a-zA-Z]" | tail -n 1)"
fi

echo $version
